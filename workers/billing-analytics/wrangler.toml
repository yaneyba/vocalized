name = "vocalized-billing-analytics"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Bindings
[[d1_databases]]
binding = "DB"
database_name = "vocalized-db"
database_id = "your-database-id-here"  # Update with actual database ID

[[kv_namespaces]]
binding = "KV"
id = "your-kv-namespace-id-here"  # Update with actual KV namespace ID

# Environment variables
[vars]
ENVIRONMENT = "development"

# Secrets (set via: wrangler secret put SECRET_NAME)
# STRIPE_SECRET_KEY
# STRIPE_WEBHOOK_SECRET

# Cron triggers for automated tasks
[[triggers.crons]]
# Daily usage aggregation at midnight
schedule = "0 0 * * *"

[[triggers.crons]]
# Monthly billing finalization on 1st at 1 AM
schedule = "0 1 1 * *"

[[triggers.crons]]
# Hourly analytics updates
schedule = "0 * * * *"

[[triggers.crons]]
# Daily analytics aggregation at 2 AM
schedule = "0 2 * * *"

# Development environment
[env.development]
vars = { ENVIRONMENT = "development" }

# Production environment
[env.production]
vars = { ENVIRONMENT = "production" }
