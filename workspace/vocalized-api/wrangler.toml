name = "vocalized-api"
main = "src/index.ts"
compatibility_date = "2024-11-04"
compatibility_flags = ["nodejs_compat"]

# D1 Database Binding
[[d1_databases]]
binding = "DB"
database_name = "vocalized-db"
database_id = "00000000-0000-0000-0000-000000000000" # Placeholder for local dev
migrations_dir = "schema/migrations"

# Environment Variables
[vars]
ENVIRONMENT = "development"
JWT_SECRET = "dev-secret-change-in-production"
JWT_EXPIRES_IN = "7d"
JWT_REFRESH_EXPIRES_IN = "30d"

# KV Namespace for sessions and rate limiting (optional)
# [[kv_namespaces]]
# binding = "SESSIONS"
# id = ""

# R2 Bucket for call recordings (optional, for later)
# [[r2_buckets]]
# binding = "RECORDINGS"
# bucket_name = "vocalized-recordings"

# Staging Environment
[env.staging]
name = "vocalized-api-staging"
vars = { ENVIRONMENT = "staging" }

[[env.staging.d1_databases]]
binding = "DB"
database_name = "vocalized-db-staging"
database_id = ""

# Production Environment
[env.production]
name = "vocalized-api-production"
vars = { ENVIRONMENT = "production" }

[[env.production.d1_databases]]
binding = "DB"
database_name = "vocalized-db-production"
database_id = ""

# Cron triggers for scheduled tasks (billing, cleanup, health checks)
# [triggers]
# crons = ["0 0 * * *"]  # Daily at midnight UTC
